# セキュリティのしくみ

# 1. セキュリティの基本的な考え方

## 1. セキュリティの基本的な考え方

### 攻撃者の目的

- セキュリティ対策は「何から何を守るのか」を明確にすることから始まる。
- 攻撃者の目的は、改ざん・破壊、政治的主張（ハクティビズム）、金銭獲得へと変化してきた。
- サイバーテロは社会インフラ（水道・電力・ガスなど）を狙い、大規模な被害を生む。

### 守るべき対象とリスク

- 企業活動を支えるのは人・物・資金に加えて情報資産（顧客情報、設計書、会計情報など）。
- 情報資産を分類し、管理責任者を任命して適切に保護する。
- 脅威：情報資産に悪影響を与える要因。リスク：脅威が現実化する可能性。
- 業務内容や脅威の頻度、リスクの度合いに応じて対策を最適化する。

### 脅威の 3 分類

- 人的脅威：内部不正など意図的な脅威と、誤操作など偶発的な脅威。
- 技術的脅威：不正アクセス、盗聴、通信の改ざん、脆弱性を突く攻撃。
- 物理的脅威：地震や火災などの災害。環境的脅威とも呼ばれる。
- 情報漏えいの約 8 割は人的脅威が原因。

### 内部不正が生まれる 3 条件

- 機会：不正が発覚しにくく、実行しやすい環境。
- 動機・プレッシャー：金銭的困窮など不正を後押しする状況。
- 正当化：自分の行為を許容する心理。

## 2. 情報セキュリティの特性

### CIA の 3 要素

- **機密性（Confidentiality）**：許可された人・システムだけが利用できる状態を保つ。
- **完全性（Integrity）**：改ざんや破壊がなく内容が正しい状態。
- **可用性（Availability）**：障害や攻撃に強く、必要なときに利用できる状態。

### CIA 以外に維持したい特性

- 真正性（Authenticity）、責任追跡性（Accountability）、否認防止（Non-repudiation）、信頼性（Reliability）など。

### コスト・利便性・安全性のバランス

- 安全性の向上にはコストや利便性とのトレードオフがある。
- 守る価値と対策コストのバランスを見極める。

## 3. アクセス制御と認証

### 権限管理の基本

- ファイルやデータベースなどへのアクセス権は必要な人だけに付与する。
- 認証（Authentication）：利用者を特定する仕組み。
- 認可（Authorization）：認証済み利用者にふさわしい権限を与える。
- 最小特権の原則：必要最小限の権限のみ付与する。

### パスワードを狙う攻撃

- ブルートフォース攻撃：あらゆる文字列を総当たりで試す。
- 辞書攻撃：よく使われるパスワードを集めた辞書で試す。
- パスワードリスト攻撃：他サービスで漏れた ID・パスワードの使い回しを悪用。

### 使い捨てパスワードと多要素認証

- ワンタイムパスワード：一度限りのパスワードで安全性を高める。
- 二段階認証もワンタイムパスワードの一種として扱われることがある。
- 認証の 3 要素：知識情報（知っていること）、所持情報（持っているもの）、生体情報（身体的特徴）。
- 多要素（2 要素）認証：複数要素を組み合わせて弱点を補完する。

### 不正ログイン対策

- リスクベース認証：アクセス状況から不正の可能性を判定する。
- CAPTCHA：機械的なログインや投稿を防ぐため、人間にしか解けない課題を提示する。

### パスワード管理の工夫

- シングルサインオン（SSO）：一度のログインで複数サービスを利用できるが、乗っ取り時の影響が大きい。
- パスワード管理ツール：マスターパスワードで複数のログイン情報を一元管理する。

## 4. 生体認証の活用

- 生体認証は古くから利用され、スマートフォンや入退室管理でも普及。
- 指紋より高精度なのが静脈認証。偽装が難しい一方、機器のサイズや導入コストが課題。
- 虹彩認証や顔認証なども今後の普及が期待される。

# 2. ネットワークを狙った攻撃

## データの盗み見（盗聴）

ネットワーク経由で通信内容を盗み見る行為を「盗聴」と呼びます。成立しうる場所は主に 2 つです。

- 通信機器：ルーターやスイッチなど経路上の装置
- 伝送媒体：無線 LAN、LAN ケーブル、専用線など
  経路に不正な機器を挿入されたり、オフィス内に盗聴用機器を設置されたりすると、技術的には盗聴が可能です。対策は「経路の暗号化」に加えて「データ自体の暗号化」を行い、どこで抜かれても内容を読まれないようにします。

## データの信頼性を脅かす攻撃（改ざん）

個人情報でなくても、送信内容と異なる内容が相手に届く可能性があります。転送途中のデータが書き換えられることを改ざんと呼びます。
集計度だけでなく、ファイルなどが書き換えられる改ざんもあります。例えば、ウェブサイトの更新に使われる FTP アカウントが乗っ取られると、ウェブサイトのコンテンツが書き換えられます。ウェブサーバーの管理者権限やコンテンツの更新権限が奪われると、その権限でアクセス可能なコンテンツを改ざんすることが可能となってしまいます。

## 特定の人物になりすます（なりすまし）

人のふりをして活動する行為を「なりすまし」と呼びます。
固定 IP からのみ接続可能なサービスに対し、自分の IP アドレスを偽装して接続する方法を IP スプーフィングと呼びます。
SNS の成りすましは防ぐのが難しいです。アカウントを持っていない人が簡単に自分の、勝手に他の人の名前を使ってアカウントを作ることもできますし、これは芸能人や著名人の場合に多く発生している事象です。本人が知らないところで勝手に悪意を持った投稿されてしまうと、本人は何もしていないのに悪者になる恐れがあります。これを防ぐために SNS のアカウントを取得だけしておくのは対策の一つとは言えます。

## 法律による不正アクセスの定義

不正に入手した他人の ID やパスワードでログインする行為は、不正アクセスに該当します。
不正アクセス禁止法では不正アクセスの定義が書かれており、シンプルに書くと以下の行為が該当します。他人の ID やパスワードを勝手に使ってシステムを利用する行為。システムの不具合などを悪用してアクセス制限を回避してシステムを利用する行為。目標のシステムを利用するために、そのネットワークにある他のコンピューターでのアクセス制限を回避してシステムを利用する行為。
いずれも電気会社を通じてアクセスしていることが前提となっており、インターネットや LAN などのネットワークを通じて不正なアクセスを行った場合に処罰の対象となります。

## 無実の人が加害者に（遠隔操作型マルウェア）

2012 年に発生した事件で、マルウェアに感染したコンピューターに不正な指令を送って遠隔操作し、掲示板などに犯行予告を投稿した遠隔操作型マルウェア事件というものがあった。

## 攻撃のための裏口を設置（バックドア/ルートキット）

入侵に成功した場所に後から入りやすくするために、バックドアと呼ばれるソフトウェアなどを攻撃者が導入することがあります。
バックドアが設置されると、既存の設定ファイルやソフトウェアが書き換えられるので、各社が提供している改ざん検知ツールなどを利用すると、設定ファイルなどが改ざんされた場合に検知するように設定でき、侵入者の発見につながります。
外部から不正侵入した攻撃者が利用するツールとして、管理者権限でシステム改変を行うツール群「ルートキット」があります。

## 負荷をかけるタイプの攻撃（DoS/DDoS・ボットネット）

非常に大量の通信でネットワークを麻痺させる攻撃を DoS（サービス拒否）攻撃と呼びます。多数のコンピューターから集中させる場合は DDoS 攻撃です。攻撃には乗っ取られた端末（ボット）を多数束ねたボットネットが悪用されます。大量メールで受信箱を埋めるメールボムも関連手口です。

## 攻撃をどこで防ぐか（入口/内部/出口・多層防御）

攻撃は概ね次の 4 段階で進みます。1.侵入（端末を感染させる）2.拡大（社内で横展開）3.調査（情報の所在を探索）4.取得（抽出して外部送信）。
侵入を防ぐ・侵入しても感染させない対策は「入口対策」。外部送信を防ぐ・送信されても影響を抑えるのは「出口対策」。これらを複数階層で組み合わせる考え方を「多層防御」と呼びます。

## 不正アクセス対策の基本（FW/フィルタリング）

インターネットと社内ネットワークの境界で門番の役割を担う機器をファイアウォールと呼びます。事前のルールに基づいて通信を許可/拒否します。送信元/宛先 IP やポート等で制御するのがパケットフィルタリングで、プロトコル単位（例：https）での制御も可能です。

## 通信の監視と分析（パケットキャプチャ）

ネットワークを流れる通信内容を調べるためにパケットを採取することをパケットキャプチャと呼びます。リピータハブは全ポートに信号を中継します。スイッチングハブは必要なポートにのみ中継しますが、ミラーリングポート搭載機なら他ポートの通信を複製して取得できます。

## 外部からの侵入を検知・防止する（IDS/IPS）

ファイアウォールだけでは不正通信をすべて見分けられません。外部からの攻撃を検知するために IDS（Intrusion Detection System：侵入検知）を用います。ネットワーク型（NIDS）とホスト型（HIDS）があり、前者は「監視カメラ」のように不審な通信を検出します。一方で、検知だけでは後手に回るため、遮断まで行う IPS（Intrusion Prevention System：侵入防止）も併用します。

## 集中管理で対策効果を上げる（UTM/SIEM/EDR）

複数のウイルス対策やファイアウォールなどを個別運用すると、設定の不整合や運用負荷が増えがちです。これらを統合して提供する製品を UTM（Unified Threat Management：統合脅威管理）と呼びます。

ただし UTM だけで全ての攻撃は防げません。異常の早期検知と原因の特定が重要で、そのためにログやイベントを横断的に収集・相関分析する仕組みを SIEM（Security Information and Event Management）と呼びます。端末側のふるまい監視と封じ込めを担う EDR（Endpoint Detection and Response）と併用して、可視化と初動対応を強化します。

## ネットワークを分割する（境界の設計）

ネットワークを設計する場合、大きく 3 つの領域に分けて考えることになります。それは内部の領域、外部に公開する領域、インターネットの領域です。
インターネットと内部ネットワークの中間に位置する領域を DMZ（Demilitarized Zone、非武装地帯）と呼び、干渉地帯としての役割を果たします。
ノート PC を社内に持ち込む際、感染があると社内へ広がる恐れがあります。社内ネットへ直結する前に、一時接続の検疫ネットワークで安全性を確認してから接続します。

## ネットワークへの接続を管理する（端末制御）

事前に登録したコンピュータ以外、社内ネットワークに接続したくない場合があります。そこでスイッチなどのネットワーク機器を利用したアクセスコントロールの代表的な方法として、MAC アドレスを用いたフィルタリング、マックアドレスフィルタリングがあります。
ただし、MAC アドレスはツールを使って変更できるためなりすましで接続される可能性もあります。また、接続する機器が増えると管理コストも増えるため、そういった問題もあります。
MAC アドレスフィルタリングは、有線のネットワークだけでなく、無線 LAN のアクセスポイントへの接続を制限する場合にも使用できます。同様に、無線 LAN への接続を管理するために SSID セグメントが使われる場合もあります。

## 安全な通信を実現する

無線 LAN セキュリティの中でも常に注目を集めるのが暗号化方式です。通信の途中で内容を見られたり盗聴されたりするのを防ぐために用いられますが、この暗号化方式を適切に選択しないと短時間で暗号文が解読され、盗聴される可能性があります。現在では短時間で解読される方法が発見されているため、WEP に関しては推奨されず、WPA 方式または WPA2 方式による暗号化が推奨されています。
実在する正規のアクセスポイントと同じ SSID 暗号化体系を設定したアクセスポイントが攻撃者によって設置されている場合があります。この場合、接続すると第三者に通信内容が知られてしまい、悪用される恐れがあります。
接続する端末を制限するために使用する認証規格として IEEE 802.1X があります。導入ハードルがありますが、企業などで接続する端末を制限したい場合には有用な対策です。

# 3. ウイルスとスパイウェア

## マルウェアの種類

「マルウェア」は悪意あるソフトウェアの総称です。代表的な種類は以下のとおりです。

- ウイルス：他のプログラムに寄生して動作する。
- ワーム：単独で自己増殖し、ネットワーク経由で感染を広げる。
- トロイの木馬：有用に見せかけ、実際は情報窃取やバックドアを仕込む。
- スパイウェア：利用者の情報を収集して外部へ送信する。
- マクロウイルス：Officeなどのマクロ機能を悪用する。

## ウイルス対策の定番

- パターンファイル（ウイルス定義）の更新：常に最新へ。定義と照合して検知・駆除する。
- 振る舞い検知：定義にない未知の脅威も「怪しい動き」で見つける。
- ハニーポット：囮の環境を用意して攻撃手口を観測・学習する。
- サンドボックス：仮想環境内で安全にプログラムを実行し、挙動を検査する。

## 偽サイト（フィッシング/ファーミング）

- フィッシング：本物を装う偽サイトで認証情報を盗む手口。
- ファーミング：DNS改ざんなどで正しいURLでも偽サイトへ誘導する手口。

URLの見た目だけでは見抜きにくいため、公式アプリからのアクセスや証明書の検証、ブックマークからのアクセスを徹底する。
